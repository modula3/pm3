# Makefile generated by imake - do not edit!
# $XConsortium: imake.c,v 1.48 89/10/10 18:33:21 jim Exp $

CPU_TYPE = mips

PREFIX = /proj
INSTALL_PREFIX = $(PREFIX)

BIN = mips/bin
BIN_USE     = $(PREFIX)/$(BIN)
BIN_INSTALL = $(INSTALL_PREFIX)/$(BIN)

PUB = m3/pub.mips
PUB_USE     = $(PREFIX)/$(PUB)
PUB_INSTALL = $(INSTALL_PREFIX)/$(PUB)

LIB = m3/lib.mips
LIB_USE     = $(PREFIX)/$(LIB)
LIB_INSTALL = $(INSTALL_PREFIX)/$(LIB)

GNUEMACS_INSTALL = $(INSTALL_PREFIX)/generic/lib/elisp

MAN = man/mips
MAN_USE  = $(PREFIX)/$(MAN)
MAN_INSTALL = $(INSTALL_PREFIX)/$(MAN)

DOC = doc
DOC_USE     = $(PREFIX)/$(DOC)
DOC_INSTALL = $(INSTALL_PREFIX)/$(DOC)

XLIBPATH = /usr/local/lib
XLIB     = -lX11

CC = cc

CC_WARNS_FOR_UNKNOWN_FILES = 0

CC_G = @-g2@

CC_O = @-O2@

KEEP_LIBRARIES_RESOLVED = 1

CFLAGS =

M3OPT = -g

BOOTOPT = -g

IMAKEFLAGS =

SHELL = /bin/sh

SHELL_PGMS = csh

CPP = /lib/cpp

MAKE = make

SEP   = @
PASS0 = @$(LIB_USE)/m3compiler@
PASS1 = @cc@-G@0@-Wf,-XNp200000@-Wf,-XNd150000@
PASS2 = @cc@-G@0@
PASS3 = @/bin/ar@cru@
PASS4 = @ranlib@
PASS5 = @/bin/ld@-A@
OVERLAY_0 = @-G@0@-g2@
OVERLAY_1 = @-lc_G0@
BASE_ARGS = @-N@

SERVER_LIMIT = 0

DEFPATH = .:$(PUB_USE)

LIBPATH = .:$(LIB_USE):$(XLIBPATH)

LINKBFILES = @-lm@
LINKFILES = @-lm3@-lm@

LINKCOVER  = $(LIB_USE)/report_coverage.o

INCL = $(LIB_USE)

TEMPLATE = toplevel.tmpl.SRC

all::

M3        = $(BIN_USE)/m3

M3FLAGS   = -w1 -make -why
M3DEFPATH =
M3LIBPATH =
DO_M3     = $(M3) $(M3FLAGS) $(M3OPT) $(M3OPTIONS) $(M3DEFPATH) $(M3LIBPATH)

X11LIBS   = -L$(XLIBPATH) -lXaw -lXmu -lXext -lXt $(XLIB)
M3X11LIBS = -lm3X11R4 $(X11LIBS)
UILIB = -lm3ui -lm3X11R4 $(XLIB)
FORMSVBTLIB = -lm3formsvbt -lm3vbtkit $(UILIB)
ZEUSLIB = -lm3mgkit -lm3mg -lm3zeus -lm3codeview $(FORMSVBTLIB)

all:: .pkgs

.pkgs:: $(M3MAKEFILE) ;\
  @echo "building import links..." ;\
  rm -rf .pkgs ;\
  mkdir .pkgs ;\
  pkgnames="$(PACKAGES)" ;\
  for PKG in $$pkgnames; do (\
     echo "   " $$PKG ;\
     $(LIB_USE)/m3mkpath .pkgs/$$PKG ;\
     rm -f .pkgs/$$PKG ;\
     ln -s  /proj/m3/pkg/$$PKG .pkgs/$$PKG \
  ); done

TANGLEFLAGS = -L'<*LINE %L "%F" *>%N'
WEAVEFLAGS = -n





































.RSRC_MODIFIED:: ../src/rsrc/BuiltIn.juno
	@touch .RSRC_MODIFIED

.RSRC_MODIFIED:: ../src/rsrc/MenuArrow.px
	@touch .RSRC_MODIFIED

.RSRC_MODIFIED:: ../src/rsrc/Macros.fv
	@touch .RSRC_MODIFIED

.RSRC_MODIFIED:: ../src/rsrc/Juno.fv
	@touch .RSRC_MODIFIED

.RSRC_MODIFIED:: ../src/rsrc/Editor.fv
	@touch .RSRC_MODIFIED

.RSRC_MODIFIED:: ../src/rsrc/AboutBox.fv
	@touch .RSRC_MODIFIED

.RSRC_MODIFIED:: ../src/rsrc/LoadModule.fv
	@touch .RSRC_MODIFIED

.RSRC_MODIFIED:: ../src/rsrc/LoadFile.fv
	@touch .RSRC_MODIFIED

.RSRC_MODIFIED:: ../src/rsrc/SaveFile.fv
	@touch .RSRC_MODIFIED

.RSRC_MODIFIED:: ../src/rsrc/Times-Roman.afm
	@touch .RSRC_MODIFIED

.RSRC_MODIFIED:: ../src/rsrc/Times-Bold.afm
	@touch .RSRC_MODIFIED

.RSRC_MODIFIED:: ../src/rsrc/Times-Italic.afm
	@touch .RSRC_MODIFIED

.RSRC_MODIFIED:: ../src/rsrc/Times-BoldItalic.afm
	@touch .RSRC_MODIFIED

.RSRC_MODIFIED:: ../src/rsrc/Helvetica.afm
	@touch .RSRC_MODIFIED

.RSRC_MODIFIED:: ../src/rsrc/Helvetica-Bold.afm
	@touch .RSRC_MODIFIED

.RSRC_MODIFIED:: ../src/rsrc/Helvetica-Oblique.afm
	@touch .RSRC_MODIFIED

.RSRC_MODIFIED:: ../src/rsrc/Helvetica-BoldOblique.afm
	@touch .RSRC_MODIFIED

.RSRC_MODIFIED:: ../src/rsrc/Courier.afm
	@touch .RSRC_MODIFIED

.RSRC_MODIFIED:: ../src/rsrc/Courier-Bold.afm
	@touch .RSRC_MODIFIED

.RSRC_MODIFIED:: ../src/rsrc/Courier-Oblique.afm
	@touch .RSRC_MODIFIED

.RSRC_MODIFIED:: ../src/rsrc/Courier-BoldOblique.afm
	@touch .RSRC_MODIFIED

all:: JunoBundle.m3 JunoBundle.i3
clean:: FRC
	rm -f JunoBundle.i3 JunoBundle.m3 .RSRC_MODIFIED
JunoBundle.i3 JunoBundle.m3: .RSRC_MODIFIED
	$(BIN_USE)/m3bundle -name JunoBundle $(RSRC_CMD)





all:: Juno
clean:: ; rm -f Juno Juno.ov Juno.b Juno.bx Juno.by
Juno: FRC ; $(DO_M3) -o Juno $(PGM_SOURCES) $(IMPORT_LIBS)

# Use incremental linker
# M3 = m3-ild

# PKGDIR = /proj/m3/pkg
PKGDIR = ../..

M3DEFPATH = -D$(PKGDIR)/juno-compiler/src -D$(PKGDIR)/juno-machine/src
M3LIBPATH = -L$(PKGDIR)/juno-compiler/mips -L$(PKGDIR)/juno-machine/mips

M3OPT = -times -g -X1@-Wf,-XNp300000@-Wf,-XNd250000@

scratch:: clean

tidy::
	find . \( -name ",*" -o -name ".,*" -o -name ".emacs_[0-9]*" \
	    -o -name "*~" -o -name core -o -name a.out \) -print | xargs rm -f

clean:: tidy
	find . \( -name "*.o" -o -name "*.io" -o -name "*.ix" \
\
		  -o -name "*.mo" -o -name "*.mx" \) -print | xargs rm -f
	rm -f .makefile .m3path* .PGM_SOURCES .EXPORT* .RSRC_CMD
	rm -f .m3imports*

checkin::     ; vmake -noeval ; vmake -ci < /dev/null
checkout::    ; vmake -co $(PACKAGE) < /dev/null
vestacreate:: ; vmake -co $(PACKAGE).1

FRC:

IMPORT_LIBS = \
  -lJC \
  -lRT \
  $(FORMSVBTLIB)
RSRC_CMD = -F.RSRC_CMD
PGM_SOURCES = -F.PGM_SOURCES
